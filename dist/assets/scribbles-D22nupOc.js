const A="/assets/underline-scribble.svg";let c=!1;async function v(e){const t=await fetch(e,{cache:"no-store"});if(!t.ok)throw new Error(`Failed to load ${e}: ${t.status}`);return t.text()}function k(e){var t,o;return e.querySelectorAll("path, line, polyline, polygon, circle, rect").forEach(s=>{s.getAttribute("stroke")||s.setAttribute("stroke","currentColor"),(!s.getAttribute("fill")||s.getAttribute("fill")!=="none")&&s.setAttribute("fill","none"),s.style.willChange="stroke-dashoffset, opacity"}),e.setAttribute("aria-hidden","true"),e.setAttribute("focusable","false"),e.classList.add("scribble-svg"),e.setAttribute("preserveAspectRatio",e.getAttribute("preserveAspectRatio")||"none"),(t=e.style).width||(t.width="100%"),(o=e.style).height||(o.height="1em"),e}function w(e){e.forEach(t=>{try{const o=t.getTotalLength();t.style.strokeDasharray=`${o}`,t.style.strokeDashoffset=`${o}`,t.style.transition="stroke-dashoffset 360ms cubic-bezier(.2,.9,.2,1)",t.style.opacity="1"}catch{}})}function b(e){e.length&&requestAnimationFrame(()=>{requestAnimationFrame(()=>{e.forEach(t=>{t.style.strokeDashoffset="0"})})})}function T(e){e.forEach(t=>{t.style.transition=""})}function l(e,t={}){if(!window.gsap||!e.length)return;const{duration:o=.95,stagger:s=.08,ease:d="power3.out",finalStrokeWidth:a=4}=t;T(e);try{window.gsap.set(e,{opacity:.35}),window.gsap.to(e,{strokeDashoffset:0,opacity:1,duration:o,ease:d,stagger:s,overwrite:"auto"}),window.gsap.fromTo(e,{strokeWidth:1.4},{strokeWidth:a,duration:Math.min(.4,o*.5),ease:"power1.out",stagger:s,overwrite:!1})}catch(y){console.warn("[scribbles] GSAP animation failed",y)}}function q(){if(c||typeof MutationObserver>"u"||!document.body)return;c=!0;const e=new MutationObserver(()=>{document.querySelector(".underline-scribble")&&(e.disconnect(),c=!1,F().catch(()=>{}))});e.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{c&&(e.disconnect(),c=!1)},2200)}async function F(e={}){const{animate:t=!0,heroControlled:o=!0}=e,s=Array.from(document.querySelectorAll(".underline-scribble"));if(!s.length){q();return}if(s.every(r=>r.querySelector(".scribble-svg"))){const r=Array.from(document.querySelectorAll(".scribble-svg path")),n=r.filter(h=>h.closest(".hero-section")),p=r.filter(h=>!h.closest(".hero-section"));t&&(p.length&&l(p),(!o||!window.gsap)&&l(n));return}let a;try{a=await v(A)}catch(r){console.error("[scribbles] Could not fetch SVG:",r);return}const f=new DOMParser().parseFromString(a,"image/svg+xml").querySelector("svg");if(!f){console.error("[scribbles] fetched file has no <svg>");return}k(f),s.forEach(r=>{if(r.querySelector(".scribble-svg"))return;const n=f.cloneNode(!0);n.style.color=window.getComputedStyle(r).color||"#ffffff",r.appendChild(n)});const i=Array.from(document.querySelectorAll(".scribble-svg path"));if(!i.length)return;w(i);const m=i.filter(r=>r.closest(".hero-section")),S=i.filter(r=>!r.closest(".hero-section")),u=!!window.gsap;function g(r,n={}){r.length&&(b(r),u&&setTimeout(()=>l(r,n),120))}t?(g(S),!o||!u?g(m):m.forEach(r=>{r.style.opacity="0"})):(!o||!u)&&b(i)}function O(){const e=Array.from(document.querySelectorAll(".scribble-svg path"));e.length&&(w(e),b(e),setTimeout(()=>l(e),120))}export{F as inlineScribbles,O as rerunScribbles};
